"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/auth/me";
exports.ids = ["pages/api/auth/me"];
exports.modules = {

/***/ "(api-node)/./lib/db.js":
/*!*******************!*\
  !*** ./lib/db.js ***!
  \*******************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var pg__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! pg */ \"pg\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([pg__WEBPACK_IMPORTED_MODULE_0__]);\npg__WEBPACK_IMPORTED_MODULE_0__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n// Create PostgreSQL connection pool\nconst pool = new pg__WEBPACK_IMPORTED_MODULE_0__.Pool({\n    connectionString: process.env.DATABASE_URL || 'postgresql://postgres:password@localhost:5432/money_flow',\n    ssl:  false ? 0 : false\n});\n// Log database connection errors\npool.on('error', (err)=>{\n    console.error('Unexpected error on idle client', err);\n    process.exit(-1);\n});\n// Execute SQL query with parameters\nconst query = async (text, params = [])=>{\n    const start = Date.now();\n    try {\n        const res = await pool.query(text, params);\n        const duration = Date.now() - start;\n        // Log slow queries (> 200ms) for debugging\n        if (duration > 200) {\n            console.log('Slow query:', {\n                text,\n                duration,\n                rows: res.rowCount\n            });\n        }\n        return res;\n    } catch (error) {\n        console.error('Database query error:', error);\n        // Add more context to the error for debugging\n        error.query = text;\n        error.params = params;\n        throw error;\n    }\n};\n// Get a client from the pool for transactions\nconst getClient = async ()=>{\n    const client = await pool.connect();\n    // Monkey patch the query method to implement the same logic as above\n    const originalQuery = client.query;\n    client.query = async (text, params = [])=>{\n        const start = Date.now();\n        try {\n            const res = await originalQuery.call(client, text, params);\n            const duration = Date.now() - start;\n            if (duration > 200) {\n                console.log('Slow query in transaction:', {\n                    text,\n                    duration,\n                    rows: res.rowCount\n                });\n            }\n            return res;\n        } catch (error) {\n            console.error('Database transaction query error:', error);\n            error.query = text;\n            error.params = params;\n            throw error;\n        }\n    };\n    return client;\n};\n// Run a function within a transaction\nconst transaction = async (callback)=>{\n    const client = await getClient();\n    try {\n        await client.query('BEGIN');\n        const result = await callback(client);\n        await client.query('COMMIT');\n        return result;\n    } catch (error) {\n        await client.query('ROLLBACK');\n        throw error;\n    } finally{\n        client.release();\n    }\n};\n// Export database operations\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({\n    query,\n    getClient,\n    transaction,\n    pool\n});\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uL2xpYi9kYi5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUEwQjtBQUUxQixvQ0FBb0M7QUFDcEMsTUFBTUMsT0FBTyxJQUFJRCxvQ0FBSUEsQ0FBQztJQUNwQkUsa0JBQWtCQyxRQUFRQyxHQUFHLENBQUNDLFlBQVksSUFBSTtJQUM5Q0MsS0FBS0gsTUFBcUMsR0FBRyxDQUE2QixHQUFHO0FBQy9FO0FBRUEsaUNBQWlDO0FBQ2pDRixLQUFLTyxFQUFFLENBQUMsU0FBUyxDQUFDQztJQUNoQkMsUUFBUUMsS0FBSyxDQUFDLG1DQUFtQ0Y7SUFDakROLFFBQVFTLElBQUksQ0FBQyxDQUFDO0FBQ2hCO0FBRUEsb0NBQW9DO0FBQ3BDLE1BQU1DLFFBQVEsT0FBT0MsTUFBTUMsU0FBUyxFQUFFO0lBQ3BDLE1BQU1DLFFBQVFDLEtBQUtDLEdBQUc7SUFDdEIsSUFBSTtRQUNGLE1BQU1DLE1BQU0sTUFBTWxCLEtBQUtZLEtBQUssQ0FBQ0MsTUFBTUM7UUFDbkMsTUFBTUssV0FBV0gsS0FBS0MsR0FBRyxLQUFLRjtRQUU5QiwyQ0FBMkM7UUFDM0MsSUFBSUksV0FBVyxLQUFLO1lBQ2xCVixRQUFRVyxHQUFHLENBQUMsZUFBZTtnQkFBRVA7Z0JBQU1NO2dCQUFVRSxNQUFNSCxJQUFJSSxRQUFRO1lBQUM7UUFDbEU7UUFFQSxPQUFPSjtJQUNULEVBQUUsT0FBT1IsT0FBTztRQUNkRCxRQUFRQyxLQUFLLENBQUMseUJBQXlCQTtRQUV2Qyw4Q0FBOEM7UUFDOUNBLE1BQU1FLEtBQUssR0FBR0M7UUFDZEgsTUFBTUksTUFBTSxHQUFHQTtRQUVmLE1BQU1KO0lBQ1I7QUFDRjtBQUVBLDhDQUE4QztBQUM5QyxNQUFNYSxZQUFZO0lBQ2hCLE1BQU1DLFNBQVMsTUFBTXhCLEtBQUt5QixPQUFPO0lBRWpDLHFFQUFxRTtJQUNyRSxNQUFNQyxnQkFBZ0JGLE9BQU9aLEtBQUs7SUFDbENZLE9BQU9aLEtBQUssR0FBRyxPQUFPQyxNQUFNQyxTQUFTLEVBQUU7UUFDckMsTUFBTUMsUUFBUUMsS0FBS0MsR0FBRztRQUN0QixJQUFJO1lBQ0YsTUFBTUMsTUFBTSxNQUFNUSxjQUFjQyxJQUFJLENBQUNILFFBQVFYLE1BQU1DO1lBQ25ELE1BQU1LLFdBQVdILEtBQUtDLEdBQUcsS0FBS0Y7WUFFOUIsSUFBSUksV0FBVyxLQUFLO2dCQUNsQlYsUUFBUVcsR0FBRyxDQUFDLDhCQUE4QjtvQkFBRVA7b0JBQU1NO29CQUFVRSxNQUFNSCxJQUFJSSxRQUFRO2dCQUFDO1lBQ2pGO1lBRUEsT0FBT0o7UUFDVCxFQUFFLE9BQU9SLE9BQU87WUFDZEQsUUFBUUMsS0FBSyxDQUFDLHFDQUFxQ0E7WUFDbkRBLE1BQU1FLEtBQUssR0FBR0M7WUFDZEgsTUFBTUksTUFBTSxHQUFHQTtZQUNmLE1BQU1KO1FBQ1I7SUFDRjtJQUVBLE9BQU9jO0FBQ1Q7QUFFQSxzQ0FBc0M7QUFDdEMsTUFBTUksY0FBYyxPQUFPQztJQUN6QixNQUFNTCxTQUFTLE1BQU1EO0lBRXJCLElBQUk7UUFDRixNQUFNQyxPQUFPWixLQUFLLENBQUM7UUFDbkIsTUFBTWtCLFNBQVMsTUFBTUQsU0FBU0w7UUFDOUIsTUFBTUEsT0FBT1osS0FBSyxDQUFDO1FBQ25CLE9BQU9rQjtJQUNULEVBQUUsT0FBT3BCLE9BQU87UUFDZCxNQUFNYyxPQUFPWixLQUFLLENBQUM7UUFDbkIsTUFBTUY7SUFDUixTQUFVO1FBQ1JjLE9BQU9PLE9BQU87SUFDaEI7QUFDRjtBQUVBLDZCQUE2QjtBQUM3QixpRUFBZTtJQUNibkI7SUFDQVc7SUFDQUs7SUFDQTVCO0FBQ0YsQ0FBQyxFQUFDIiwic291cmNlcyI6WyIvVXNlcnMva2V2aW56dW5pZ2EvRGV2ZWxvcG1lbnQva2V2aW4vZmxvd2FwcC9tb25leS1mbG93L2xpYi9kYi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQb29sIH0gZnJvbSAncGcnO1xuXG4vLyBDcmVhdGUgUG9zdGdyZVNRTCBjb25uZWN0aW9uIHBvb2xcbmNvbnN0IHBvb2wgPSBuZXcgUG9vbCh7XG4gIGNvbm5lY3Rpb25TdHJpbmc6IHByb2Nlc3MuZW52LkRBVEFCQVNFX1VSTCB8fCAncG9zdGdyZXNxbDovL3Bvc3RncmVzOnBhc3N3b3JkQGxvY2FsaG9zdDo1NDMyL21vbmV5X2Zsb3cnLFxuICBzc2w6IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAncHJvZHVjdGlvbicgPyB7IHJlamVjdFVuYXV0aG9yaXplZDogZmFsc2UgfSA6IGZhbHNlXG59KTtcblxuLy8gTG9nIGRhdGFiYXNlIGNvbm5lY3Rpb24gZXJyb3JzXG5wb29sLm9uKCdlcnJvcicsIChlcnIpID0+IHtcbiAgY29uc29sZS5lcnJvcignVW5leHBlY3RlZCBlcnJvciBvbiBpZGxlIGNsaWVudCcsIGVycik7XG4gIHByb2Nlc3MuZXhpdCgtMSk7XG59KTtcblxuLy8gRXhlY3V0ZSBTUUwgcXVlcnkgd2l0aCBwYXJhbWV0ZXJzXG5jb25zdCBxdWVyeSA9IGFzeW5jICh0ZXh0LCBwYXJhbXMgPSBbXSkgPT4ge1xuICBjb25zdCBzdGFydCA9IERhdGUubm93KCk7XG4gIHRyeSB7XG4gICAgY29uc3QgcmVzID0gYXdhaXQgcG9vbC5xdWVyeSh0ZXh0LCBwYXJhbXMpO1xuICAgIGNvbnN0IGR1cmF0aW9uID0gRGF0ZS5ub3coKSAtIHN0YXJ0O1xuICAgIFxuICAgIC8vIExvZyBzbG93IHF1ZXJpZXMgKD4gMjAwbXMpIGZvciBkZWJ1Z2dpbmdcbiAgICBpZiAoZHVyYXRpb24gPiAyMDApIHtcbiAgICAgIGNvbnNvbGUubG9nKCdTbG93IHF1ZXJ5OicsIHsgdGV4dCwgZHVyYXRpb24sIHJvd3M6IHJlcy5yb3dDb3VudCB9KTtcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIHJlcztcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdEYXRhYmFzZSBxdWVyeSBlcnJvcjonLCBlcnJvcik7XG4gICAgXG4gICAgLy8gQWRkIG1vcmUgY29udGV4dCB0byB0aGUgZXJyb3IgZm9yIGRlYnVnZ2luZ1xuICAgIGVycm9yLnF1ZXJ5ID0gdGV4dDtcbiAgICBlcnJvci5wYXJhbXMgPSBwYXJhbXM7XG4gICAgXG4gICAgdGhyb3cgZXJyb3I7XG4gIH1cbn07XG5cbi8vIEdldCBhIGNsaWVudCBmcm9tIHRoZSBwb29sIGZvciB0cmFuc2FjdGlvbnNcbmNvbnN0IGdldENsaWVudCA9IGFzeW5jICgpID0+IHtcbiAgY29uc3QgY2xpZW50ID0gYXdhaXQgcG9vbC5jb25uZWN0KCk7XG4gIFxuICAvLyBNb25rZXkgcGF0Y2ggdGhlIHF1ZXJ5IG1ldGhvZCB0byBpbXBsZW1lbnQgdGhlIHNhbWUgbG9naWMgYXMgYWJvdmVcbiAgY29uc3Qgb3JpZ2luYWxRdWVyeSA9IGNsaWVudC5xdWVyeTtcbiAgY2xpZW50LnF1ZXJ5ID0gYXN5bmMgKHRleHQsIHBhcmFtcyA9IFtdKSA9PiB7XG4gICAgY29uc3Qgc3RhcnQgPSBEYXRlLm5vdygpO1xuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXMgPSBhd2FpdCBvcmlnaW5hbFF1ZXJ5LmNhbGwoY2xpZW50LCB0ZXh0LCBwYXJhbXMpO1xuICAgICAgY29uc3QgZHVyYXRpb24gPSBEYXRlLm5vdygpIC0gc3RhcnQ7XG4gICAgICBcbiAgICAgIGlmIChkdXJhdGlvbiA+IDIwMCkge1xuICAgICAgICBjb25zb2xlLmxvZygnU2xvdyBxdWVyeSBpbiB0cmFuc2FjdGlvbjonLCB7IHRleHQsIGR1cmF0aW9uLCByb3dzOiByZXMucm93Q291bnQgfSk7XG4gICAgICB9XG4gICAgICBcbiAgICAgIHJldHVybiByZXM7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0RhdGFiYXNlIHRyYW5zYWN0aW9uIHF1ZXJ5IGVycm9yOicsIGVycm9yKTtcbiAgICAgIGVycm9yLnF1ZXJ5ID0gdGV4dDtcbiAgICAgIGVycm9yLnBhcmFtcyA9IHBhcmFtcztcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfTtcbiAgXG4gIHJldHVybiBjbGllbnQ7XG59O1xuXG4vLyBSdW4gYSBmdW5jdGlvbiB3aXRoaW4gYSB0cmFuc2FjdGlvblxuY29uc3QgdHJhbnNhY3Rpb24gPSBhc3luYyAoY2FsbGJhY2spID0+IHtcbiAgY29uc3QgY2xpZW50ID0gYXdhaXQgZ2V0Q2xpZW50KCk7XG4gIFxuICB0cnkge1xuICAgIGF3YWl0IGNsaWVudC5xdWVyeSgnQkVHSU4nKTtcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjYWxsYmFjayhjbGllbnQpO1xuICAgIGF3YWl0IGNsaWVudC5xdWVyeSgnQ09NTUlUJyk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBhd2FpdCBjbGllbnQucXVlcnkoJ1JPTExCQUNLJyk7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH0gZmluYWxseSB7XG4gICAgY2xpZW50LnJlbGVhc2UoKTtcbiAgfVxufTtcblxuLy8gRXhwb3J0IGRhdGFiYXNlIG9wZXJhdGlvbnNcbmV4cG9ydCBkZWZhdWx0IHtcbiAgcXVlcnksXG4gIGdldENsaWVudCxcbiAgdHJhbnNhY3Rpb24sXG4gIHBvb2xcbn07XG4iXSwibmFtZXMiOlsiUG9vbCIsInBvb2wiLCJjb25uZWN0aW9uU3RyaW5nIiwicHJvY2VzcyIsImVudiIsIkRBVEFCQVNFX1VSTCIsInNzbCIsInJlamVjdFVuYXV0aG9yaXplZCIsIm9uIiwiZXJyIiwiY29uc29sZSIsImVycm9yIiwiZXhpdCIsInF1ZXJ5IiwidGV4dCIsInBhcmFtcyIsInN0YXJ0IiwiRGF0ZSIsIm5vdyIsInJlcyIsImR1cmF0aW9uIiwibG9nIiwicm93cyIsInJvd0NvdW50IiwiZ2V0Q2xpZW50IiwiY2xpZW50IiwiY29ubmVjdCIsIm9yaWdpbmFsUXVlcnkiLCJjYWxsIiwidHJhbnNhY3Rpb24iLCJjYWxsYmFjayIsInJlc3VsdCIsInJlbGVhc2UiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api-node)/./lib/db.js\n");

/***/ }),

/***/ "(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fauth%2Fme&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fauth%2Fme.js&middlewareConfigBase64=e30%3D!":
/*!************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fauth%2Fme&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fauth%2Fme.js&middlewareConfigBase64=e30%3D! ***!
  \************************************************************************************************************************************************************************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/route-modules/pages-api/module.compiled */ \"(api-node)/./node_modules/next/dist/server/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(api-node)/./node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api-node)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_auth_me_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages/api/auth/me.js */ \"(api-node)/./pages/api/auth/me.js\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_pages_api_auth_me_js__WEBPACK_IMPORTED_MODULE_3__]);\n_pages_api_auth_me_js__WEBPACK_IMPORTED_MODULE_3__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_auth_me_js__WEBPACK_IMPORTED_MODULE_3__, 'default'));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_auth_me_js__WEBPACK_IMPORTED_MODULE_3__, 'config');\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/auth/me\",\n        pathname: \"/api/auth/me\",\n        // The following aren't used in production.\n        bundlePath: '',\n        filename: ''\n    },\n    userland: _pages_api_auth_me_js__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uL25vZGVfbW9kdWxlcy9uZXh0L2Rpc3QvYnVpbGQvd2VicGFjay9sb2FkZXJzL25leHQtcm91dGUtbG9hZGVyL2luZGV4LmpzP2tpbmQ9UEFHRVNfQVBJJnBhZ2U9JTJGYXBpJTJGYXV0aCUyRm1lJnByZWZlcnJlZFJlZ2lvbj0mYWJzb2x1dGVQYWdlUGF0aD0uJTJGcGFnZXMlMkZhcGklMkZhdXRoJTJGbWUuanMmbWlkZGxld2FyZUNvbmZpZ0Jhc2U2ND1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7O0FBQStGO0FBQ3ZDO0FBQ0U7QUFDMUQ7QUFDbUQ7QUFDbkQ7QUFDQSxpRUFBZSx3RUFBSyxDQUFDLGtEQUFRLFlBQVksRUFBQztBQUMxQztBQUNPLGVBQWUsd0VBQUssQ0FBQyxrREFBUTtBQUNwQztBQUNPLHdCQUF3Qix5R0FBbUI7QUFDbEQ7QUFDQSxjQUFjLGtFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsWUFBWTtBQUNaLENBQUM7O0FBRUQscUMiLCJzb3VyY2VzIjpbIiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQYWdlc0FQSVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvcm91dGUtbW9kdWxlcy9wYWdlcy1hcGkvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBob2lzdCB9IGZyb20gXCJuZXh0L2Rpc3QvYnVpbGQvdGVtcGxhdGVzL2hlbHBlcnNcIjtcbi8vIEltcG9ydCB0aGUgdXNlcmxhbmQgY29kZS5cbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIuL3BhZ2VzL2FwaS9hdXRoL21lLmpzXCI7XG4vLyBSZS1leHBvcnQgdGhlIGhhbmRsZXIgKHNob3VsZCBiZSB0aGUgZGVmYXVsdCBleHBvcnQpLlxuZXhwb3J0IGRlZmF1bHQgaG9pc3QodXNlcmxhbmQsICdkZWZhdWx0Jyk7XG4vLyBSZS1leHBvcnQgY29uZmlnLlxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IGhvaXN0KHVzZXJsYW5kLCAnY29uZmlnJyk7XG4vLyBDcmVhdGUgYW5kIGV4cG9ydCB0aGUgcm91dGUgbW9kdWxlIHRoYXQgd2lsbCBiZSBjb25zdW1lZC5cbmV4cG9ydCBjb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBQYWdlc0FQSVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5QQUdFU19BUEksXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9hdXRoL21lXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvYXV0aC9tZVwiLFxuICAgICAgICAvLyBUaGUgZm9sbG93aW5nIGFyZW4ndCB1c2VkIGluIHByb2R1Y3Rpb24uXG4gICAgICAgIGJ1bmRsZVBhdGg6ICcnLFxuICAgICAgICBmaWxlbmFtZTogJydcbiAgICB9LFxuICAgIHVzZXJsYW5kXG59KTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cGFnZXMtYXBpLmpzLm1hcCJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fauth%2Fme&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fauth%2Fme.js&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api-node)/./pages/api/auth/me.js":
/*!******************************!*\
  !*** ./pages/api/auth/me.js ***!
  \******************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jsonwebtoken */ \"jsonwebtoken\");\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(jsonwebtoken__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var cookie__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! cookie */ \"cookie\");\n/* harmony import */ var cookie__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(cookie__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _lib_db__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../lib/db */ \"(api-node)/./lib/db.js\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_lib_db__WEBPACK_IMPORTED_MODULE_2__]);\n_lib_db__WEBPACK_IMPORTED_MODULE_2__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\nasync function handler(req, res) {\n    if (req.method !== 'GET') {\n        return res.status(405).json({\n            message: 'Method not allowed'\n        });\n    }\n    // Check for token in cookies\n    const cookies = cookie__WEBPACK_IMPORTED_MODULE_1___default().parse(req.headers.cookie || '');\n    const token = cookies.token;\n    if (!token) {\n        return res.status(401).json({\n            message: 'Not authenticated'\n        });\n    }\n    try {\n        // Verify token\n        const decoded = jsonwebtoken__WEBPACK_IMPORTED_MODULE_0___default().verify(token, process.env.JWT_SECRET || 'your-secret-key');\n        // Get user from database\n        const result = await _lib_db__WEBPACK_IMPORTED_MODULE_2__[\"default\"].query('SELECT id, email, nombre FROM users WHERE id = $1', [\n            decoded.userId\n        ]);\n        const user = result.rows[0];\n        if (!user) {\n            return res.status(404).json({\n                message: 'User not found'\n            });\n        }\n        res.status(200).json({\n            user\n        });\n    } catch (error) {\n        console.error('Authentication error:', error);\n        // Clear invalid token\n        res.setHeader('Set-Cookie', cookie__WEBPACK_IMPORTED_MODULE_1___default().serialize('token', '', {\n            httpOnly: true,\n            secure: \"development\" === 'production',\n            expires: new Date(0),\n            path: '/',\n            sameSite: 'strict'\n        }));\n        res.status(401).json({\n            message: 'Invalid or expired token'\n        });\n    }\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uL3BhZ2VzL2FwaS9hdXRoL21lLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7OztBQUErQjtBQUNIO0FBQ0s7QUFFbEIsZUFBZUcsUUFBUUMsR0FBRyxFQUFFQyxHQUFHO0lBQzVDLElBQUlELElBQUlFLE1BQU0sS0FBSyxPQUFPO1FBQ3hCLE9BQU9ELElBQUlFLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7WUFBRUMsU0FBUztRQUFxQjtJQUM5RDtJQUVBLDZCQUE2QjtJQUM3QixNQUFNQyxVQUFVVCxtREFBWSxDQUFDRyxJQUFJUSxPQUFPLENBQUNYLE1BQU0sSUFBSTtJQUNuRCxNQUFNWSxRQUFRSCxRQUFRRyxLQUFLO0lBRTNCLElBQUksQ0FBQ0EsT0FBTztRQUNWLE9BQU9SLElBQUlFLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7WUFBRUMsU0FBUztRQUFvQjtJQUM3RDtJQUVBLElBQUk7UUFDRixlQUFlO1FBQ2YsTUFBTUssVUFBVWQsMERBQVUsQ0FBQ2EsT0FBT0csUUFBUUMsR0FBRyxDQUFDQyxVQUFVLElBQUk7UUFFNUQseUJBQXlCO1FBQ3pCLE1BQU1DLFNBQVMsTUFBTWpCLHFEQUFRLENBQzNCLHFEQUNBO1lBQUNZLFFBQVFPLE1BQU07U0FBQztRQUdsQixNQUFNQyxPQUFPSCxPQUFPSSxJQUFJLENBQUMsRUFBRTtRQUUzQixJQUFJLENBQUNELE1BQU07WUFDVCxPQUFPakIsSUFBSUUsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztnQkFBRUMsU0FBUztZQUFpQjtRQUMxRDtRQUVBSixJQUFJRSxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO1lBQUVjO1FBQUs7SUFDOUIsRUFBRSxPQUFPRSxPQUFPO1FBQ2RDLFFBQVFELEtBQUssQ0FBQyx5QkFBeUJBO1FBRXZDLHNCQUFzQjtRQUN0Qm5CLElBQUlxQixTQUFTLENBQ1gsY0FDQXpCLHVEQUFnQixDQUFDLFNBQVMsSUFBSTtZQUM1QjJCLFVBQVU7WUFDVkMsUUFBUWIsa0JBQXlCO1lBQ2pDYyxTQUFTLElBQUlDLEtBQUs7WUFDbEJDLE1BQU07WUFDTkMsVUFBVTtRQUNaO1FBR0Y1QixJQUFJRSxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO1lBQUVDLFNBQVM7UUFBMkI7SUFDN0Q7QUFDRiIsInNvdXJjZXMiOlsiL1VzZXJzL2tldmluenVuaWdhL0RldmVsb3BtZW50L2tldmluL2Zsb3dhcHAvbW9uZXktZmxvdy9wYWdlcy9hcGkvYXV0aC9tZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgand0IGZyb20gJ2pzb253ZWJ0b2tlbic7XG5pbXBvcnQgY29va2llIGZyb20gJ2Nvb2tpZSc7XG5pbXBvcnQgZGIgZnJvbSAnLi4vLi4vLi4vbGliL2RiJztcblxuZXhwb3J0IGRlZmF1bHQgYXN5bmMgZnVuY3Rpb24gaGFuZGxlcihyZXEsIHJlcykge1xuICBpZiAocmVxLm1ldGhvZCAhPT0gJ0dFVCcpIHtcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDUpLmpzb24oeyBtZXNzYWdlOiAnTWV0aG9kIG5vdCBhbGxvd2VkJyB9KTtcbiAgfVxuXG4gIC8vIENoZWNrIGZvciB0b2tlbiBpbiBjb29raWVzXG4gIGNvbnN0IGNvb2tpZXMgPSBjb29raWUucGFyc2UocmVxLmhlYWRlcnMuY29va2llIHx8ICcnKTtcbiAgY29uc3QgdG9rZW4gPSBjb29raWVzLnRva2VuO1xuXG4gIGlmICghdG9rZW4pIHtcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLmpzb24oeyBtZXNzYWdlOiAnTm90IGF1dGhlbnRpY2F0ZWQnIH0pO1xuICB9XG5cbiAgdHJ5IHtcbiAgICAvLyBWZXJpZnkgdG9rZW5cbiAgICBjb25zdCBkZWNvZGVkID0gand0LnZlcmlmeSh0b2tlbiwgcHJvY2Vzcy5lbnYuSldUX1NFQ1JFVCB8fCAneW91ci1zZWNyZXQta2V5Jyk7XG4gICAgXG4gICAgLy8gR2V0IHVzZXIgZnJvbSBkYXRhYmFzZVxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLnF1ZXJ5KFxuICAgICAgJ1NFTEVDVCBpZCwgZW1haWwsIG5vbWJyZSBGUk9NIHVzZXJzIFdIRVJFIGlkID0gJDEnLFxuICAgICAgW2RlY29kZWQudXNlcklkXVxuICAgICk7XG5cbiAgICBjb25zdCB1c2VyID0gcmVzdWx0LnJvd3NbMF07XG4gICAgXG4gICAgaWYgKCF1c2VyKSB7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLmpzb24oeyBtZXNzYWdlOiAnVXNlciBub3QgZm91bmQnIH0pO1xuICAgIH1cblxuICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgdXNlciB9KTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdBdXRoZW50aWNhdGlvbiBlcnJvcjonLCBlcnJvcik7XG4gICAgXG4gICAgLy8gQ2xlYXIgaW52YWxpZCB0b2tlblxuICAgIHJlcy5zZXRIZWFkZXIoXG4gICAgICAnU2V0LUNvb2tpZScsXG4gICAgICBjb29raWUuc2VyaWFsaXplKCd0b2tlbicsICcnLCB7XG4gICAgICAgIGh0dHBPbmx5OiB0cnVlLFxuICAgICAgICBzZWN1cmU6IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAncHJvZHVjdGlvbicsXG4gICAgICAgIGV4cGlyZXM6IG5ldyBEYXRlKDApLFxuICAgICAgICBwYXRoOiAnLycsXG4gICAgICAgIHNhbWVTaXRlOiAnc3RyaWN0JyxcbiAgICAgIH0pXG4gICAgKTtcbiAgICBcbiAgICByZXMuc3RhdHVzKDQwMSkuanNvbih7IG1lc3NhZ2U6ICdJbnZhbGlkIG9yIGV4cGlyZWQgdG9rZW4nIH0pO1xuICB9XG59XG5cbiJdLCJuYW1lcyI6WyJqd3QiLCJjb29raWUiLCJkYiIsImhhbmRsZXIiLCJyZXEiLCJyZXMiLCJtZXRob2QiLCJzdGF0dXMiLCJqc29uIiwibWVzc2FnZSIsImNvb2tpZXMiLCJwYXJzZSIsImhlYWRlcnMiLCJ0b2tlbiIsImRlY29kZWQiLCJ2ZXJpZnkiLCJwcm9jZXNzIiwiZW52IiwiSldUX1NFQ1JFVCIsInJlc3VsdCIsInF1ZXJ5IiwidXNlcklkIiwidXNlciIsInJvd3MiLCJlcnJvciIsImNvbnNvbGUiLCJzZXRIZWFkZXIiLCJzZXJpYWxpemUiLCJodHRwT25seSIsInNlY3VyZSIsImV4cGlyZXMiLCJEYXRlIiwicGF0aCIsInNhbWVTaXRlIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api-node)/./pages/api/auth/me.js\n");

/***/ }),

/***/ "cookie":
/*!*************************!*\
  !*** external "cookie" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("cookie");

/***/ }),

/***/ "jsonwebtoken":
/*!*******************************!*\
  !*** external "jsonwebtoken" ***!
  \*******************************/
/***/ ((module) => {

module.exports = require("jsonwebtoken");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "pg":
/*!*********************!*\
  !*** external "pg" ***!
  \*********************/
/***/ ((module) => {

module.exports = import("pg");;

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fauth%2Fme&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fauth%2Fme.js&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();